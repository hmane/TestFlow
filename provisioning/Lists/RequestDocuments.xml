<pnp:ListInstance xmlns:pnp="http://schemas.dev.office.com/PnP/2022/09/ProvisioningSchema"
                  Title="RequestDocuments"
                  Description="Document library for request attachments and approval files"
                  TemplateType="101"
                  Url="RequestDocuments"
                  OnQuickLaunch="true"
                  EnableVersioning="true"
                  EnableMinorVersions="false"
                  EnableFolderCreation="false">

  <pnp:Fields>
    <Field Type="Choice"
           DisplayName="Document Type"
           Name="DocumentType"
           ID="{B6D2F593-667D-4731-B6CE-8879937F19EC}"
           Required="TRUE"
           Group="Document Metadata">
      <CHOICES>
        <CHOICE>Review</CHOICE>
        <CHOICE>Supplemental</CHOICE>
        <CHOICE>Communication Approval</CHOICE>
        <CHOICE>Portfolio Manager Approval</CHOICE>
        <CHOICE>Research Analyst Approval</CHOICE>
        <CHOICE>Subject Matter Expert Approval</CHOICE>
        <CHOICE>Performance Approval</CHOICE>
        <CHOICE>Other Approval</CHOICE>
        <CHOICE>Review Final</CHOICE>
      </CHOICES>
    </Field>

    <Field Type="Lookup"
           DisplayName="Request"
           Name="Request"
           ID="{1A1D1177-DF07-433C-BAE5-27D2BC82C050}"
           Required="TRUE"
           List="Lists/Requests"
           ShowField="Title"
           Group="Document Metadata" />

    <Field Type="Note"
           DisplayName="Description"
           Name="Description"
           ID="{ACC418A3-B576-4DE0-B523-6AF87815386D}"
           Required="FALSE"
           RichText="FALSE"
           NumLines="6"
           Group="Document Metadata" />
  </pnp:Fields>

  <pnp:Views RemoveExistingViews="true">
    <!-- All Documents - Flat view (no folder structure) -->
    <pnp:View Name="AllDocuments" DisplayName="All Documents" DefaultView="true" RowLimit="100" Paged="true" Scope="Recursive">
      <pnp:Query>
        <OrderBy>
          <FieldRef Name="Modified" Ascending="FALSE" />
        </OrderBy>
      </pnp:Query>
      <pnp:ViewFields>
        <FieldRef Name="DocIcon" />
        <FieldRef Name="LinkFilename" />
        <FieldRef Name="Request" />
        <FieldRef Name="DocumentType" />
        <FieldRef Name="Modified" />
        <FieldRef Name="Editor" />
      </pnp:ViewFields>
      <CustomFormatter>{"commandBarProps":{"commands":[{"key":"new","hide":true},{"key":"newComposite","hide":true},{"key":"upload","hide":true},{"key":"UploadCommand","hide":true},{"key":"edit","hide":true},{"key":"delete","hide":true},{"key":"share","hide":true},{"key":"copyLink","hide":true},{"key":"automate","hide":true},{"key":"integrate","hide":true},{"key":"alertMe","hide":true},{"key":"manageAlert","hide":true},{"key":"powerBI","hide":true},{"key":"powerBIVisualizeList","hide":true},{"key":"editInGridView","hide":true},{"key":"sync","hide":true},{"key":"syncCommand","hide":true},{"key":"download","hide":false,"primary":true,"position":0,"sectionType":"Primary"},{"key":"exportExcel","hide":false,"position":1,"sectionType":"Primary"}]}}</CustomFormatter>
    </pnp:View>

    <!-- By Document Type - Flat view -->
    <pnp:View Name="ByDocumentType" DisplayName="By Document Type" DefaultView="false" RowLimit="100" Paged="true" Scope="Recursive">
      <pnp:Query>
        <OrderBy>
          <FieldRef Name="DocumentType" Ascending="TRUE" />
          <FieldRef Name="Modified" Ascending="FALSE" />
        </OrderBy>
      </pnp:Query>
      <pnp:ViewFields>
        <FieldRef Name="DocIcon" />
        <FieldRef Name="LinkFilename" />
        <FieldRef Name="Request" />
        <FieldRef Name="DocumentType" />
        <FieldRef Name="Modified" />
      </pnp:ViewFields>
      <CustomFormatter>{"commandBarProps":{"commands":[{"key":"new","hide":true},{"key":"newComposite","hide":true},{"key":"upload","hide":true},{"key":"UploadCommand","hide":true},{"key":"edit","hide":true},{"key":"delete","hide":true},{"key":"share","hide":true},{"key":"copyLink","hide":true},{"key":"automate","hide":true},{"key":"integrate","hide":true},{"key":"alertMe","hide":true},{"key":"manageAlert","hide":true},{"key":"powerBI","hide":true},{"key":"powerBIVisualizeList","hide":true},{"key":"editInGridView","hide":true},{"key":"sync","hide":true},{"key":"syncCommand","hide":true},{"key":"download","hide":false,"primary":true,"position":0,"sectionType":"Primary"},{"key":"exportExcel","hide":false,"position":1,"sectionType":"Primary"}]}}</CustomFormatter>
    </pnp:View>

    <!-- By Request - Flat view -->
    <pnp:View Name="ByRequest" DisplayName="By Request" DefaultView="false" RowLimit="100" Paged="true" Scope="Recursive">
      <pnp:Query>
        <OrderBy>
          <FieldRef Name="Request" Ascending="TRUE" />
          <FieldRef Name="Modified" Ascending="FALSE" />
        </OrderBy>
      </pnp:Query>
      <pnp:ViewFields>
        <FieldRef Name="DocIcon" />
        <FieldRef Name="LinkFilename" />
        <FieldRef Name="DocumentType" />
        <FieldRef Name="Request" />
        <FieldRef Name="Modified" />
      </pnp:ViewFields>
      <CustomFormatter>{"commandBarProps":{"commands":[{"key":"new","hide":true},{"key":"newComposite","hide":true},{"key":"upload","hide":true},{"key":"UploadCommand","hide":true},{"key":"edit","hide":true},{"key":"delete","hide":true},{"key":"share","hide":true},{"key":"copyLink","hide":true},{"key":"automate","hide":true},{"key":"integrate","hide":true},{"key":"alertMe","hide":true},{"key":"manageAlert","hide":true},{"key":"powerBI","hide":true},{"key":"powerBIVisualizeList","hide":true},{"key":"editInGridView","hide":true},{"key":"sync","hide":true},{"key":"syncCommand","hide":true},{"key":"download","hide":false,"primary":true,"position":0,"sectionType":"Primary"},{"key":"exportExcel","hide":false,"position":1,"sectionType":"Primary"}]}}</CustomFormatter>
    </pnp:View>
  </pnp:Views>

</pnp:ListInstance>
